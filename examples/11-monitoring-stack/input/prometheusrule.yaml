apiVersion: monitoring.coreos.com/v1
kind: PrometheusRule
metadata:
  name: myapp
  namespace: default
spec:
  groups:
  - name: myapp.rules
    interval: 30s
    rules:
    - alert: MyappHighErrorRate
      expr: |
        rate(myapp_errors_total[5m]) > 0.05
      for: 5m
      labels:
        severity: warning
      annotations:
        summary: High error rate in myapp
        description: "Error rate is {{ $value | humanizePercentage }}"
    - alert: MyappHighMemory
      expr: |
        container_memory_usage_bytes{pod=~"myapp-.*"} / 1024 / 1024 > 200
      for: 5m
      labels:
        severity: warning
      annotations:
        summary: High memory usage in myapp
        description: "Memory usage is {{ $value }}MB"
